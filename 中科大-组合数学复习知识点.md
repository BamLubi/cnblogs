[TOC]

## 一、鸽巢原理

**定理：$n+1$个物品放入$n$个盒子中，那至少有 1 个盒子中至少有 2 个物品。**

解题思路：

- 构造部分和序列

- $正整数a_{i}=2^{s_{i}} \times r_{i}, \ s_{i}为非负整数, r_{i}为奇数$

**加强形式：$m$个物品放入$n$个盒子中，至少有 1 个盒子中至少有$\left \lceil \frac{m}{n} \right \rceil $个物品。**

> 若物品数与盒子数相等，则至少 1 个盒子中至少有 1 个物品。
>
> 若$m=n+1$，则至少 1 一个盒子中至少有 2 个物品。

解题思路：

- 递增子序列问题：构造$\{ m_{k} \},m_{k}表示从a_{k}开始的最长递增子序列长度$
- 将集合分成 n 部分，使用加强形式
- 取余

## 二、排列与组合

### 2.1 集合的排列组合

$$
\begin{align}
r排列 &= P(n,r) = A_{n}^{r} = \frac{n!}{(n-r)!} \\
r圆排列 &= \frac{1}{r}P(n,r) = \frac{1}{r}A_{n}^{r} = \frac{n!}{r(n-r)!} \\
r组合数 &= \binom{n}{r} = C_{n}^{r} = \frac{n!}{r!(n-r)!}
\end{align}
$$

**定理：$\binom{n}{0} + \binom{n}{1} + \cdots + \binom{n}{n} = 2^{n}$**

解题思路：

- 能被 3 整除的数，各位数字之和也要能被 3 整除

### 2.2 多重集合

**定理：多重集合$M=\{ \infty \cdot a_{1}, \infty \cdot a_{2}, \cdots , \infty \cdot a_{k} \}$的 $r$ 排列数为$k^{r}$**.

**定理：多重集合$M=\{ k_{1} \cdot a_{1}, k_{2} \cdot a_{2}, \cdots , k_{n} \cdot a_{n} \}$的全排列数为$\frac{(k_{1}+k_{2}+\cdots+k_{n})!}{k_{1}!k_{2}!\cdots k_{n}!}$**.只适用全排列，如果 k 排列，则用指数型生成函数。

**定理：多重集合$M=\{ \infty \cdot a_{1}, \infty \cdot a_{2}, \cdots , \infty \cdot a_{k} \}$的 $r$ 组合数为$\binom{k+r-1}{r}=C_{k+r-1}^{r}$**.

> 证明方法：对应求**非负整数解**方案数$x_{1}+x_{2}+\cdots+x_{k}=r$
>
> =>r 个相同的球放入 k 个不同的盒子中

**定理：多重集合$M=\{ \infty \cdot a_{1}, \infty \cdot a_{2}, \cdots , \infty \cdot a_{k} \}$，要求各元素至少出现一次的 $r$ 组合数为$\binom{r-1}{k-1}=C_{r-1}^{k-1}$**.

> 证明方法：对应求**满足一定条件的整数解**方案数$x_{1}+x_{2}+\cdots+x_{k}=r,x_{i} \ge 1$
>
> 例题：求方程$x_{1}+x_{2}+x_{3}+x_{4}=18$满足条件$x_{1}\ge3, x_{2}\ge1,x_{3}\ge4,x_{4}\ge2$的整数解数目。
>
> 解：令$y_1=x_1-3,y_2=x_2-1,y_3=x_3-4.y_4=x_4-2$，则原方程变为$y_1+y_2+y_3+y_4=8$的非负整数解数目，$\binom{8+4-1}{8}$

- [ ] 课后习题 13，不穿过直线 $y=x$ 的非降路径数？

## 三、二项式系数

**二项式定理：$(x+y)^n = x^n + \binom{n}{1}x^{n-1}y + \binom{n}{2}x^{n-1}y^2 +\cdots+y^n = \sum_{i=0}^{n} \binom{n}{i}x^{n-i}y^i$**

**牛顿二项式定理：$(1+x)^\alpha=\sum_{r=0}^\infty \binom{\alpha}{r}x^r,\binom{\alpha}{r}=\frac{\alpha(\alpha-1)\cdots(\alpha-r+1)}{r!},\alpha为一切实数,|x|<1$**

> - $\alpha=-n$ 时，有 $\binom{\alpha}{r} = (-1)^r \binom{n+r-1}{r}$
>   - $(1+x)^{-n}=\sum_{r=0}^{\infty} (-1)^r \binom{n+r-1}{r} x^r$
>   - $(1-x)^{-n}=\sum_{r=0}^{\infty} \binom{n+r-1}{r} x^r$
>   - $(1+x)^{-1} = 1-x+x^2-x^3+\cdots$
>   - $(1-x)^{-1} = 1+x+x^2+x^3+\cdots$
> - $\alpha=\frac{1}{2}$ 时，有 $\binom{\alpha}{r} = (-1)^{r-1}\frac{1}{r 2^{2r-1}} \binom{2r-2}{r-1}$
>   - $(1+x)^{\frac{1}{2}} = \sum_{r=1}^{\infty} (-1)^{r-1}\frac{1}{r 2^{2r-1}} \binom{2r-2}{r-1} x^r,Catalan数$

**基本性质：**

- **对称关系：$\binom{n}{r} = \binom{n}{n-r}$**
- **递推关系：$\binom{n}{r} = \binom{n-1}{r} + \binom{n-1}{r-1} = C_{n-1}^r + C_{n-1}^{r-1}$**

**组合恒等式：**

- $C_n^1 + 2C_n^2 + 3C_n^3 + \cdots + nC_n^n = n2^{n-1}$

- $C_0^k + C_1^k + C_2^k + \cdots + C_n^k = C_{n+1}^{k+1}$

- $\sum_{i=0}^{n} (C_{n}^{i})^2 = C_{2n}^{n}$
- $\sum_{i=0}^{r} C_m^i C_n^{r-i} = C_{m+n}^r , Vandermonde恒等式$

- $\sum_{i=0}^{m} C_m^i C_n^{r+i} = C_{m+n}^{m+r}$

**多项式定理：$(x_1+x_2+\cdots+x_t)^n = \sum \binom{n}{n_1n_2\cdots n_t} x_1^{n_1}x_2^{n_2} \cdots x_t^{n_t} , \binom{n}{n_1n_2\cdots n_t} = \frac{n!}{n_1!n_2! \cdots n_t!}$**

> 例题：展开 $(2x_1-3x_2+5x_3)^6$ ，则 $x_1^3x_2x_3^2$ 系数为
>
> 解：$\frac{6!}{3!1!2!}2^3(-3)5^2$

**多项式定理性质：**

- 展开式项数为 $n_1+n_2+\cdots+n_t=n$ 的非负整数解个数，为 $\binom{n+t-1}{n}$

- $\sum \binom{n}{n_1n_2\cdots n_t} = t^n , 令所有x_i都为1$

## 四、容斥原理

**定理：$| \overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_m} | = |S| - \sum|A_i| + \sum|A_i \cap A_j| + \cdots + (-1)^m|A_1 \cap A_2 \cap \cdots \cap A_m|$**

**推论：$|A_1 \cup A_2 \cup \cdots \cup A_m | = |S| - | \overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_m}|$**

> 欧拉函数的证明
>
> - 欧拉函数表示小于 $n$ 且与 $n$ 互素的整数的个数
> - $n=p_1^{i_1}p_2^{i_1} \cdots p_q^{i_q}$
> - 记 $A_i= \{ x| x \le n 且 p_i | x \}$ ，表示与 $p_i$ 成倍数的那些数
> - 那么 $\varphi(n) = |\overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_q}|=n\prod_{i=1}^{q}(1-\frac{1}{p_i})$

**定义：**

- $N(P_{i_1},P_{i_2},\cdots,P_{i_k})$ 表示 $S$ 中具有性质 $P_{i_1},P_{i_2},\cdots,P_{i_k}$ 的元素个数

- $\omega(k)=\sum N(P_{i_1},P_{i_2},\cdots,P_{i_k})$ 表示具备 $k$ 个性质的元素计数，其中一个元素会被多次计数。因此要计算出具备 $k$ 个性质的元素个数，用 $N(k)$

  - $\omega(0)=|S|$

- $N(r)=\omega(r)-\binom{r+1}{r}\omega(r+1)+\binom{r+2}{r}\omega(r+2)+\cdots+(-1)^{m-r}\binom{m}{r}\omega(m)$

  - 特别的，当 $r=0$ 时，表示不具备所有性质的元素个数，等同于上述定理，即：
    $$
    |\overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_m}|
    =N(0)
    =\omega(0)-\omega(1)+\omega(2)+\cdots+(-1)^m\omega(m)
    $$

解题思路：

- 不满足所有性质的个数，用定理或者 $N(0)$
- 满足几个性质的个数，用 $N(r)$

### 4.1 有限重数的多重集合的组合数

例题：求 $S=\{ \infty \cdot a,3 \cdot b, 5 \cdot c, 7 \cdot d \}$ 的 10 组合数。

1. 先假设为无限重数的多重集合，计算出 $|S|=\binom{10+4-1}{10}$

2. 定义性质集合 $P=\{P_i | P_i表示10组合数中某一位的个数要大于等于x \}$

3. 将满足性质 $P_i$ 的 10 组合数全体记为 $A_i$
4. $|A_i|=\binom{10+4-1-x}{10-x}$ 表示为，$10-x$ 组合数，再拼接上 $x$ 个该数。
5. 则题目要求解的即是 $N(0) 或 |\overline{A_1} \cap \overline{A_2} \cap \overline{A_3}|$

### 4.2 错排问题

**定理：$D_n=n![1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+\cdots+(-1)^n\frac{1}{n!}] = n!e(-1)$**

> 利用容斥原理，解决有禁止模式的错排问题

### 4.3 棋子多项式

> 在全排列中，要求某些位置不能出现特定内容。因此，记 $P_i:i位置出现特定内容$ ，则所求结果为：
>
> $$
> N(0)=\omega(0)-\omega(1)+\omega(2)+\cdots +(-1)^n\omega(n) \\
> \omega(k)=(选中k个限制位置的方法数) \times(n-k)!
> $$
>
> 因此，只需要计算出选出 $k$ 个限制位置的方法数即可。我们画出题目要求的棋盘，在变换为具有连通阴影的棋盘，方便使用棋子多项式计算。
>
> 算出 $R(x,B)$ 后带入定理即可求解。

**定理：设 $B$ 为棋盘，有限制位置的安排 $n$ 个不同物体的方法总数为 $n!-r_1(B)(n-1)!+r_2(B)(n-2)!+\cdots+(-1)^nr_n(B)0!,r_i(B)表示选出i个限制位置的方法数$**

**棋子多项式：$R(x,B_k)=\sum r_i(B_k)x^i,r_i(B_k)表示从子棋盘B_k选出i个限制位置的方法数$**

**引理：$R(x,B)=R(x,B_1) \cdot R(x,B_2)$**

> **错排**就是棋盘中主对角线不能放元素。

### 4.4 Mobius 反演

> 对于任意>1 的自然数 n，可以进行唯一的素因数分解

**Mobius 函数：$\mu(n)=\begin{cases} 1 ,n=1\\ 0,n的素因数分解中某个素数的幂>1 \\ (-1)^r , 所有素数的幂都为1\end{cases}$**

**引理：$\sum_{d|n} \mu(d)= \begin{cases} 1 ,n=1\\ 0,n>1\end{cases}$ ，即对于除了 1 以外的所有 $n$ ，其所有因子的 Mobius 函数值和为 0。**

**Mobius 反演定律：**

$$
f(n)=\sum_{d|n}g(d)=\sum_{d|n}g(\frac{n}{d}) \\
则g(n)=\sum_{d|n}\mu(d)f(\frac{n}{d})
$$

**n 可重圆排列个数：$T(n)=\frac{1}{n}\sum_{d|n}\varphi(d)m^{\frac{n}{d}}$**

## 五、生成函数

> 思想：对一个数列，使用幂级数将其作为一个整体研究。记这个幂级数 $A(x)$ 为生成函数，并记为 $G\{a_n\}$

**生成函数性质：**

- $b_k=\sum_{i=0}^{k}a_i,则B(x)=\frac{A(x)}{1-x}$
- $b_k=\sum_{i=k}^{\infty}a_i,则B(x)=\frac{A(1)-xA(x)}{1-x}$

- $b_k=ka_k,则B(x)=xA'(x)$

- $b_k=\frac{a_k}{k+1},则B(x)=\frac{1}{x}\int_0^xA(t)dt$

**常见生成函数：**

- [x] $G\{1\}=1+x+x^2+\cdots=\frac{1}{1-x}$
- [ ] $G\{a^k\}=1+ax+a^2x^2+\cdots=\frac{1}{1-ax}$
- [ ] $G\{k\}=x+2x^2+3x^3+\cdots=\frac{x}{(1-x)^2}$
- [x] $G\{k^2\}=x+4x^2+9x^3+\cdots=\frac{x(1+x)}{(1-x)^3}$
- [ ] $G\{k(k+1)\}=2x+6x^2+12x^3+\cdots=\frac{2x}{(1-x)^3}$
- [ ] $G\{k(k+1)(k+2)\}=6x+24x^2+60x^3+\cdots=\frac{6x}{(1-x)^4}$
- [x] $G\{\frac{1}{k!}\}=1+x+\frac{1}{2}x^2+\cdots=e^x$
- [ ] $G\{\binom{\alpha}{k}\}=1+\binom{\alpha}{1}x+\binom{\alpha}{2}x^2+\cdots=(1+x)^\alpha$

- [x] $G\{\binom{n+k}{k}\}=1+\binom{n+1}{1}x+\binom{n+2}{2}x^2+\cdots=\frac{1}{(1-x)^{n+1}}$

解题思路：

- 给生成函数，求数列：往常见生成函数上靠。出现 $bx^i$ ，那么 $a_i$ 项最后要加上 $b$

- 求级数和：
  - 将级数中每一项都作为 $a_i$
  - 求出 $A\{a_n\}$
  - 级数和 $=b_n=\sum_{i=0}^{n} a_i$
  - 求 ${b_n}$ 的生成函数 $B(x)=\frac{A(x)}{1-x}$
  - $x^n$ 的系数即为解

### 5.1 组合型分配问题的生成函数

**例题：**求不定方程 $x_1+x_2+x_3+x_4=20$ 满足 $x_1\ge3,x_2\ge2,x_3\ge4,x_4\ge0$ 的整数解个数

**解：**$M_i:x_i可能的取值$ ，那么

$M_1:\{3,4,5,\cdots\}$

$M_2:\{2,3,4,\cdots\}$

$M_3:\{4,5,6,\cdots\}$

$M_4:\{0,1,2,\cdots\}$

该组合型分配问题的生成函数为：$(x^3+x^4+\cdots)(x^2+x^3+\cdots)(x^4+x^5+\cdots)(1+x+\cdots)$

则化简后：$=x^9(1+x+x^2+\cdots)^4=x^9\frac{1}{(1-x)^4}=x^9\sum_{k=0}^{\infty} \binom{3+k}{k}x^k$

则 $x^{20}$ 的系数就为满足条件的整数解个数

### 5.2 排列型分配问题的指数型生成函数

> 数列 $\{a_n\}$ 的指数型生成函数定义为：$\sum_{k=0}^{\infty}a_k\frac{x^k}{k!}$
>
> 特别的，对于数列 $\{1,1,1,\cdots\}$ 的指数型生成函数为：$e(x)=\sum_{k=0}^{\infty}\frac{x^k}{k!}$
>
> **性质（特别是 3、4、5 条）：**
>
> - $e(0)=1$
> - $e(x)e(y)=e(x+y)$
> - $e^a(x)=e(ax)$
> - $\frac{x}{1!}+\frac{x^3}{3!}+\frac{x^5}{5!}+\cdots = \frac{e(x)-e(-x)}{2}$
> - $1+\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots = \frac{e(x)+e(-x)}{2}$

解题思路：

- 列出所有的 $M_i$

- 写出指数型生成函数，并化简为 $f(e(x))$ 的形式
- $\frac{x^n}{n!}$ 的系数即为所求

### 5.3 正整数分拆

> 分拆数中不能有 0，如果有 0，则等价于第二章的等式的非负整数解。

**定理：正整数 $n$ 的有序 $k$ 分拆的个数为 $\binom{n-1}{k-1}$**

> 推导：有限制条件（每个数字大于等于 1）的非负整数解。

无序分拆中，使用 $B(n,k)表示n的k分拆的个数$，有如下性质：

- $B(n,k)=0,k>n$
- $B(n,1)=B(n,n)=1$
- $B(n+k,k)=B(n,1)+B(n,2)+\cdots+B(n,k)$

- $B(n,2)=\left \lfloor \frac{n}{2} \right \rfloor $

**`Ferres`图：**将 $n$ 的 $k$ 分拆的每个分部量表示成一排点

**共轭`Ferres`图：**将原有图转置

**共轭分拆：**共轭`Ferres`图表示的分拆

**自共轭分拆：**分拆与共轭分拆相同

性质：

- 自共轭分拆个数 = 各分部量都是奇数且两两不同的分拆个数
- 分部量两两不同的分拆个数 = 分部量都是奇数的分拆个数

$$
\begin{align}

n个分部量不超过r \ \sum_{n=0}^{\infty}B_r(n)x^n &= \frac{1}{(1-x)(1-x^2) \cdots (1-x^r)} \\
n个分部量属于集合H \ \sum_{n=0}^{\infty}B_H(n)x^n &= \prod_{j \in H} \frac{1}{1-x^j} \\
所有分拆 \ \sum_{n=0}^{\infty}B(n)x^n &= \frac{1}{(1-x)(1-x^2) \cdots (1-x^{\infty})}

\end{align}
$$

## 六、递推关系

### 6.1 常系数线性齐次递推关系求解

**一般形式：$f(n)=c_1f(n-1)+c_2f(n-2)+\cdots+c_kf(n-k)$**

**特征方程：$x^k-c_1x^{k-1}-c_2x^{k-2}-\cdots-c_k=0$，其 $k$ 个根为特征根 $q_1,q_2,\cdots,q_k$。**

**通解：$f(n)=b_1q_1^n +b_2q_2^n+\cdots+b_kq_k^n$**

**带入特殊值求解**

如果 $q_i$ 为 $e$ 重根，则 $q^n,nq^n,n^2q^n,\cdots,n^{e-1}q^n$ 都是原递推关系的解，因此，其系数不再是常数项，而变为 $(b_{i_1}+b_{i_2}n+\cdots+b_{i_e}n^{e-1})q^n$

### 6.2 常系数线性非齐次递推关系求解

**一般形式：$f(n)=c_1f(n-1)+c_2f(n-2)+\cdots+c_kf(n-k)+g(n)$**

**$通解 = 齐次通解 + 非齐次特解$**

**特解的设计形式：**

| g(n)     | 特征多项式           | 特解一般形式                     |
| -------- | -------------------- | -------------------------------- |
| $3^n$    | 3 不是特征根         | $a 3^n$                          |
| $3^n$    | 3 是 $m$ 重特征根    | $an^m3^n$                        |
| $n^3$    | **1**不是特征根      | $b_0+b_1n+\cdots+b_3n^3$         |
| $n^3$    | **1**是 $m$ 重特征根 | $(b_0+b_1n+\cdots+b_3n^3)n^m$    |
| $3^nn^3$ | 3 不是特征根         | $(b_0+b_1n+\cdots+b_3n^3)3^n$    |
| $3^nn^3$ | 3 是 $m$ 重特征根    | $(b_0+b_1n+\cdots+b_3n^3)3^nn^m$ |

> 只要是重根，都得填上 $n^m$

### 6.3 用生成函数求解

解题思路：

- 令 $A(x)=\sum_{n=0}^{\infty}f(n)x^n$
- 注意 n 的取值范围
- 解出 $A(x)$ ，则 $x^n$ 的系数即为 $f(n)$

## 七、特殊计数序列

### 7.1 Fibonacci 数

> $\begin{cases} f(n)=f(n-1)+f(n-2),n\ge2\\ f(0)=1,f(1)=1 \end{cases}$
>
> **特征方程：$x^2-x-1=0$**
>
> **通解：$f(n)=\frac{1}{\sqrt{5}}(\frac{1+\sqrt{5}}{2})^{n+1}-\frac{1}{\sqrt{5}}(\frac{1-\sqrt{5}}{2})^{n+1},(n=0,1,2,\cdots)$**

**性质：**

- $f(n)=C_n^0+C_{n-1}^1+C_{n-2}^2+\cdots+C_{n-k}^k,k=\left \lfloor \frac{n}{2} \right \rfloor$

- $f(0)+f(1)+\cdots+f(n)=f(n+2)-1,全部项和$
- $f(0)+f(2)+\cdots+f(2n)=f(2n+1),偶数项和$
- $f(1)+f(3)+\cdots+f(2n-1)=f(2n)-1,奇数项和$
- $f^2(0)+f^2(1)+\cdots+f^2(n)=f(n)f(n+1),平方和$

### 7.2 Catalan 数

> **递推关系式：**$f(n)=\sum_{k=1}^{n-1}f(k)f(n-k)=f(1)f(n-1)+f(2)f(n-2)+\cdots+f(n-1)f(1)$，即每一组中参数和为 $n$
>
> **通解：**$h(n)=f(n)=\frac{1}{n} \binom{2n-2}{n-1}$
>
> **特别的：**$h(n+1)=\frac{1}{n+1}\binom{2n}{n}$

解题思路：

- 出栈顺序，讨论 $a_1$ 出栈的位置
- 使用 $g(n)=f(n-1)$ 来满足递推关系式，最后化简 $g(n)$ 为 $h(n)$ 的形式

### 7.3 集合分划和第二类 Stirling 数

> **$k$ 划分：**指的是将一个集合划分为 $k$ 个非空不相交子集，且这些子集的并集为原集合。
>
> 划分与无序分拆不同，划分的集合内部是不同的。而无序拆分是相同的。

**第二类 Stirling 数：一个 $n$ 元集合的全部 $k$ 划分的个数 $S(n,k)$**

> 相当于把 $n$ 个球分成 $k$ 类，且每一类不能为空。

**性质：**

- $S(n,1)=S(n,n)=1$
- $S(n,k)=0,k>n$

- **递推关系：**$S(n+1,k)=S(n,k-1)+kS(n,k)$

- $S(n,2)=2^{n-1}-1$
- $S(n,n-1)=C_n^2$

### 7.4 分配问题

- 不同的球，不同的盒子，允许空盒 == 一个球有 r 种选择
- 不同的球，不同的盒子，不允许空盒 == k 分划
- 相同的球，不同的盒子，允许空盒 == 非负整数解
- 相同的球，不同的盒子，不允许空盒 == 正整数解

## 八、Polya 计数理论

- 置换不满足交换律，且**从右往左**计算

- **8 次 24 阶置换群**，表示集合 $D$ 有 8 个元素，置换群种有 24 种置换

- 一个轮换有 $k$ 种表示方式
- $D=\{1,2,\cdots,n\}上所有的置换记为S_n,阶为n!$
- $S_n的子群叫做n次置换群$

**映射等价：**从 $D$ 到 $R$ 的映射全体记为 $F=\{f|f:D \rightarrow R\}$，$G$ 为 $D$ 上的置换群，对 $F$ 中任意的置换，均存在 $\sigma \in G $，满足 $f_1(d)=f_2(\sigma(d))$，则称 $f_1和f_2是G等价$。

**定理：$S_n$ 中属于 $1^{b_1}2^{b_2}\cdots n^{b_n}$ 型的置换个数为 $\frac{n!}{b_1!b_2!\cdots b_n! 1^{b_1}2^{b_2}\cdots n^{b_n}}$**

**共轭类：$G$ 是 $S_n$ 的子群，$s,t \in S_n$，若存在 $g \in G$，使得 $s = g^{-1}tg$，则称 $s与t是G共轭$。**

**引理：$s,t共轭 \Leftrightarrow s,t同型$。**（写题时要给出定义中的证明 $gs=tg$）

**k 不动置换类：** $G是\{1,2,\cdots,n\}$上的置换群,$k$ 不动类为**使元素 $k$ 保持不动**的置换全体 $Z_k={\sigma|\sigma \in G,\sigma(k)=k}$

**元素等价：**$G是\{1,2,\cdots,n\}$ 上的置换群，$\forall k,l \in D, \exists \sigma \in G,使\sigma(k)=l$，则称 $k与l是G等价$

**k 等价类：**元素 $k$ 所在的等价类，记为 $E_k$

**引理：**$|E_k| \cdot |Z_k| = |G|$

**Burnside 引理：**

$$
G=\{a_1,a_2,\cdots,a_g\}是\{1,2,\cdots,n\}上的置换群
\\
G诱导的等价类个数为l=\frac{1}{|G|}\sum_{i=1}^g c_1(a_i)
\\
c_1(a_i):置换a_i作用下不动的元素个数=轮换因子长度为1的个数
$$

**Polya 计数定理：**

$$
G是\{1,2,\cdots,n\}上的置换群,R=\{r_1,r_2,\cdots,r_n\},F=\{f|f:D \rightarrow R\}
\\
轮换指标P_G(x_1,x_2,\cdots,x_n)=\frac{1}{|G|}\sum_{\pi \in G} x_1^{b_1}x_2^{b_2}\cdots x_n^{b_n},\pi是1^{b_1}2^{b_2}\cdots n^{b_n}型 \\
F上等价类个数=P_G(|R|,|R|,\cdots,|R|) \\
F上模式表=P_G(\sum_{r \in R} \omega(r), \sum_{r \in R} \omega^3(r), \cdots, \sum_{r \in R} \omega^n(r))
$$

> 指定模式的方案数，就为 $\prod_{r \in R} \omega^{a_r}(r)$ 的系数。

**常见置换：**

- **项链问题：**n 次二面体置换（正 n 边形旋转+翻转） $D_n=\{ \sigma_I,\sigma,\cdots,\sigma^{n-1}, \tau, \tau\sigma,\cdots,\tau\sigma^{n-1}\},\sigma=(12\cdots n),\tau=(1n)(2\ n-1)\cdots$
- **r 圆排列数 或 正 n 边形只能旋转：** $\sigma:绕圆心旋转\frac{360}{r}度的置换,G=\{ \sigma^1, \sigma^2, \cdots , \sigma^r=\sigma_I \}$，讨论 $\sigma^i$ 的型
  - $i与r互素,为r^1,\varphi(r)个$
  - $i与r有最大公因子d,为(\frac{r}{d})^d型,\varphi(\frac{r}{d})个$
- **正四面体着色：**
  - 恒等置换，型为 $1^4$，有 1 个
  - 绕一个顶点和对面中点连线旋转 120°，240°，型为 $1^13^1$，有 8 个
  - 绕相对两边中点连线为轴旋转 180°，型为 $2^2$，有 3 个

## 十、组合设计

### 10.1 平衡不完全区组设计

**平衡不完全区组设计：**$(b,v,r,k,\lambda)-BIBD$

$$
\begin{align}
S = & \{s_1,s_2,\cdots,s_v\},\mathfrak{B} = \{B_1,B_2,\cdots,B_b \}
\\
(1) &\ |B_i|=k \\
(2) &\ S中任何元素均属于r个区组 \\
(3) &\ S中任何一对元素均包含在 \lambda 个区组中 \\
(4) &\ S中有v个元素,\mathfrak{B}中有b个区组
\end{align}
$$

> **平衡：**区组容量相同；元素出现次数相同；一堆元素相遇次数相同；
>
> **不完全：**$k<v$ 即每一个区组并不是包含所有元素

**平凡设计：**$k=0,1,2,v-2,v-1,v$ 的平衡不完全区组设计

**对称平衡不完全区组设计：**$b=v,r=k,记为(v,k,\lambda)-SBIBD$

**关联矩阵：**(每一行都代表着一个区组，每一列都代表着该元素是否出现在这个区组内)

$$
A=(a_{ij})_{b \times v},其中a_{ij}=
\begin{cases}
1,s_j \in B_i
\\
0,s_j \notin B_i
\end{cases}
$$

**BIBD 性质：**

- $b\ge v,r\ge k$
- $bk=vr且\lambda(v-1)=r(k-1)$
- $A^TA=(r-\lambda)I_v+\lambda J_v;I_v为单位矩阵;J_v为全1矩阵;A^TA为主对角全r，其余为\lambda;$

- $AW_v=kW_b,W_n=\begin{pmatrix} 1 \\ \vdots \\ 1 \end{pmatrix}_{n \times 1}$

**SBIBD 性质：**

- BIBD 性质
- 如果 $2|v$，则 $k-\lambda$ 是一个完全平方数
- $|B_i \cap B_j|=\lambda$

---

**三连系$(b,v,r,3,\lambda)-BIBD$**

**Steiner 三连系$(b,v,r,3,1)-BIBD$，记为 $ST(v)$**

- 充要条件：$v \equiv 1 或 3 (mod \ 6)$
- **可分解 $ST(v)$：**所有区组可以分成若干平行类，且每个平行类都是基集 $S$ 的一个分划。**充要条件**：$v \equiv 3(mod \ 6)$
- **定理：**$若 \exist ST(v_1),ST(v_2),则 \exist ST(v_1v_2)$
- 区组个数$b=\frac{1}{6}v(v-1)$

**设计 $ST(v_1v_2)$:**

$$
\mathfrak{B}_1 是基集S_1=\{a_1,a_2,\cdots,a_{v_1}\}上的ST(v_1) ;
\mathfrak{B}_2 是基集S_1=\{b_1,b_2,\cdots,b_{v_1}\}上的ST(v_2)
$$

$$
\begin{align}
S = \{
&c_{11}, c_{12}, \cdots, c_{1v_2}, \\
&c_{21}, c_{22}, \cdots, c_{2v_2}, \\
&\cdots\cdots \cdots \cdots \cdots \\
&c_{v_11}, c_{v_12}, \cdots, c_{v_1v_2}
\}
\end{align}
$$

按照以下三种方式定义 $ST(v_1v_2)中的三元组\{c_{ir},c_{js},c_{kt}  \}$

1. $r=s=t,\{ a_i, a_j, a_k \} \in \mathfrak{B_1},共\frac{1}{6}v_1(v_1-1)v_2个$
2. $i=j=k,\{ b_r, b_s, b_t \} \in \mathfrak{B_2},共\frac{1}{6}v_2(v_2-1)v_1个$
3. $\{ a_i, a_j, a_k \} \in \mathfrak{B_1},\{ b_r, b_s, b_t \} \in \mathfrak{B_2},共\frac{1}{6}v_1(v_1-1)v_2(v_2-1)个$

### 10.2 几何设计

**不可约多项式：**$F_{p}[x]上的n次多项式f(x)不可以分解成两个低次多项式之积$

- $2次不可约多项式:x^2+x+1$
- $3次不可约多项式:x^3+x+1$
- $4次不可约多项式:x^4+x^3+x^2+x+1$

$$
F_p=\{ 0, 1, 2, \cdots, p \} \\
有限域F_{p^n} = \{ \alpha_0 + \alpha_1a + \cdots + \alpha_{n-1}a^{n-1} | \alpha_0,\alpha_1,\cdots,\alpha_{n-1} \in F_p \}
$$

例题：构造 $F_8$

解：

1. $p=2, n=3$
2. $F_2[x]上的3次不可约多项式f(x)=x^3+x+1$
3. $a是f(x)=0的一个根,则a^3=a+1$
4. $F_8=\{ \alpha_0 + \alpha_1a + \alpha_2a^2 | \alpha_0,\alpha_1,\alpha_2 \in F_2 \}$

**构造射影平面、仿射平面？**

### 10.3 正交拉丁方

**拉丁方：**$n$ 阶**方阵** $A$ 的**每行每列**都是 $\{1,2,\cdots,n\}$ 的**全排列**。即，每行每列元素两两不同。

**正交拉丁方：**任意有序偶只存在一个。即，不存在两个位置，相应元素组成的二维数组相同。

> 不存在正交的 2 阶拉丁方

**正交拉丁方完备组：**$A_1,A_2,\cdots,A_{n-1}是一组n阶正交拉丁方$

**使用有限域构造正交拉丁方完备组：**

1. $设<F,+,\cdot>是有限域,其中F=\{ 0,1,\cdots,q-1\},|F|=q=p^n$
2. 写出**加法表**和**乘法表**
3. 构造 $A^{(1)},A^{(2)},\cdots,A^{(q-1)}$，其中 $A^{(e)}=(a_{ij}^{(e)})$，其中 $a_{ij}^{(e)}=a_e \cdot a_i+a_j$
4. 使用 $1,2,\cdots,q$ 替换 $0,1,\cdots,q-1$

**性质：**$A_1,A_2,\cdots,A_k是一组n阶正交拉丁方$，$B_1,B_2,\cdots,B_k是一组m阶正交拉丁方$，则可以构造$C_1,C_2,\cdots,C_k为一组mn阶正交拉丁方$。

## 常见问题总结

无限重多重集合$M=\{ \infty \cdot a_{1}, \infty \cdot a_{2}, \cdots , \infty \cdot a_{k} \}$:

- $r$ 排列数：$k^r$
- $r$ 组合数：$C_{r+k-1}^{r}$
- $r$ 圆排列：Polya 计数定理，循环群、欧拉函数

有限重多重集合$M=\{ k_{1} \cdot a_{1}, k_{2} \cdot a_{2}, \cdots , k_{n} \cdot a_{n} \}$:

- 全排列：$\frac{(k_1+k_2+\cdots+k_n)!}{k_1!k_2!\cdots k_n!}$
- $r$ 排列：指数型生成函数
- $r$ 组合：生成函数 / 容斥原理（先算无限重的，然后减去每一个数字的限制）

有限制条件的不定方程解：生成函数 / 无限重 $r$ 组合数
